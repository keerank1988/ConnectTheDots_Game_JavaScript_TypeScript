{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./build/ClientAPI.js","webpack:///./build/controllers/gameController.js","webpack:///./build/controllers/messageController.js","webpack:///./build/controllers/nodeController.js","webpack:///./build/controllers/playerController.js","webpack:///./build/controllers/stateController.js","webpack:///./build/index.js"],"names":[],"mappings":";QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;AClFa;AACb,8CAA8C,cAAc;AAC5D;AACA,0BAA0B,mBAAO,CAAC,iFAAiC;AACnE;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,qC;;;;;;;;;;;;ACVa;AACb,8CAA8C,cAAc;AAC5D;AACA,wBAAwB,mBAAO,CAAC,iEAAmB;AACnD,yBAAyB,mBAAO,CAAC,mEAAoB;AACrD,uBAAuB,mBAAO,CAAC,+DAAkB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA,0C;;;;;;;;;;;;AC1Ba;AACb,8CAA8C,cAAc;AAC5D;AACA,uBAAuB,mBAAO,CAAC,+DAAkB;AACjD,uBAAuB,mBAAO,CAAC,+DAAkB;AACjD,yBAAyB,mBAAO,CAAC,mEAAoB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6C;;;;;;;;;;;;AC7Ba;AACb,8CAA8C,cAAc;AAC5D;AACA,yBAAyB,mBAAO,CAAC,mEAAoB;AACrD,wBAAwB,mBAAO,CAAC,iEAAmB;AACnD,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0C;;;;;;;;;;;;AC/Ea;AACb,8CAA8C,cAAc;AAC5D;AACA,0BAA0B,mBAAO,CAAC,qEAAqB;AACvD,mBAAmB;AACnB,mBAAmB;AACnB,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA,4C;;;;;;;;;;;;AClCa;AACb;AACA;AACA,gDAAgD,OAAO;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,cAAc;AAC5D;AACA,uBAAuB,mBAAO,CAAC,+DAAkB;AACjD;AACA;AACA;AACA,qCAAqC,mBAAmB;AACxD,yCAAyC,0BAA0B;AACnE;AACA;AACA;AACA;AACA,2CAA2C,6CAA6C,EAAE;AAC1F;AACA;AACA;AACA;AACA;AACA,2BAA2B,iCAAiC;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,wDAAwD,EAAE;AAC3G;AACA;AACA;AACA;AACA,gEAAgE,iCAAiC,EAAE;AACnG;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA,4DAA4D;AAC5D,qCAAqC,iDAAiD,qDAAqD,EAAE,GAAG;AAChJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA,iEAAiE,kDAAkD,EAAE;AACrH,+DAA+D,kDAAkD,EAAE;AACnH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,aAAa;AAC1C;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA,2C;;;;;;;;;;;;AC/Ha;AACb;AACA;AACA,kCAAkC,oCAAoC,aAAa,EAAE,EAAE;AACvF,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA,yCAAyC,6BAA6B;AACtE,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,cAAc;AAC5D,6BAA6B,mBAAO,CAAC,yCAAa;AAClD;AACA,iC","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./build/index.js\");\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.start = void 0;\nvar messageController_1 = require(\"./controllers/messageController\");\nexports.start = function (app) {\n    app.ports.request.subscribe(function (message) {\n        var payload = JSON.parse(message);\n        messageController_1.handleRequest(payload);\n    });\n};\n//# sourceMappingURL=ClientAPI.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.logMessage = exports.initGame = void 0;\nvar stateController_1 = require(\"./stateController\");\nvar playerController_1 = require(\"./playerController\");\nvar nodeController_1 = require(\"./nodeController\");\nexports.initGame = function () {\n    playerController_1.setActivePlayer(playerController_1.player1);\n    stateController_1.setActiveNode(nodeController_1.EMPTY_NODE);\n    return {\n        msg: \"INITIALIZE\" /* INITIALIZE */,\n        body: {\n            newLine: null,\n            heading: playerController_1.getActivePlayer().name,\n            message: \"Awaiting \" + playerController_1.getActivePlayer().name + \"'s Move\"\n        }\n    };\n};\nexports.logMessage = function () {\n    var message = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        message[_i] = arguments[_i];\n    }\n    // tslint:disable-next-line:no-console\n    console.log.apply(console, message);\n};\n//# sourceMappingURL=gameController.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sendResponse = exports.handleRequest = void 0;\nvar gameController_1 = require(\"./gameController\");\nvar nodeController_1 = require(\"./nodeController\");\nvar playerController_1 = require(\"./playerController\");\nexports.handleRequest = function (payload) {\n    var response = null;\n    gameController_1.logMessage('REQUEST', payload);\n    switch (payload.msg) {\n        case \"INITIALIZE\" /* INITIALIZE */:\n            response = gameController_1.initGame();\n            break;\n        case \"NODE_CLICKED\" /* NODE_CLICKED */:\n            response = nodeController_1.onNodeClicked(payload.body);\n            break;\n        case \"ERROR\" /* ERROR */:\n            gameController_1.logMessage('ERROR', payload);\n            break;\n    }\n    if (response) {\n        exports.sendResponse(response);\n    }\n    playerController_1.startPlayerTimer();\n};\nexports.sendResponse = function (payload) {\n    gameController_1.logMessage('REQUEST', payload);\n    app.ports.response.send(payload);\n};\n//# sourceMappingURL=messageController.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.onNodeClicked = exports.EMPTY_NODE = void 0;\nvar playerController_1 = require(\"./playerController\");\nvar stateController_1 = require(\"./stateController\");\nexports.EMPTY_NODE = { x: -1, y: -1 };\nexports.onNodeClicked = function (node) {\n    var response;\n    if (stateController_1.getActiveNode() === exports.EMPTY_NODE) {\n        var valid = stateController_1.isValidStartNode(node);\n        if (valid) {\n            response = {\n                msg: \"VALID_START_NODE\" /* VALID_START_NODE */,\n                body: {\n                    newLine: null,\n                    heading: playerController_1.getActivePlayer().name,\n                    message: \"Select a second node to complete the line.\"\n                }\n            };\n            stateController_1.addStartNode(node);\n        }\n        else {\n            response = {\n                msg: \"INVALID_START_NODE\" /* INVALID_START_NODE */,\n                body: {\n                    newLine: null,\n                    heading: playerController_1.getActivePlayer().name,\n                    message: \"Not a valid starting position.\"\n                }\n            };\n        }\n    }\n    else {\n        var valid = stateController_1.isValidEndNode(node);\n        if (valid) {\n            var start = stateController_1.getActiveNode();\n            stateController_1.addEndNode(node);\n            playerController_1.togglePlayer();\n            if (stateController_1.isGameOver()) {\n                response = {\n                    msg: \"GAME_OVER\" /* GAME_OVER */,\n                    body: {\n                        newLine: {\n                            start: start,\n                            end: node\n                        },\n                        heading: 'Game Over',\n                        message: playerController_1.getActivePlayer().name + \" Wins!\"\n                    }\n                };\n            }\n            else {\n                response = {\n                    msg: \"VALID_END_NODE\" /* VALID_END_NODE */,\n                    body: {\n                        newLine: {\n                            start: start,\n                            end: node\n                        },\n                        heading: playerController_1.getActivePlayer().name,\n                        message: \"\"\n                    }\n                };\n            }\n        }\n        else {\n            response = {\n                msg: \"INVALID_END_NODE\" /* INVALID_END_NODE */,\n                body: {\n                    newLine: null,\n                    heading: playerController_1.getActivePlayer().name,\n                    message: \"Invalid move!\"\n                }\n            };\n            stateController_1.removeEndNode();\n        }\n    }\n    return response;\n};\n//# sourceMappingURL=nodeController.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.startPlayerTimer = exports.togglePlayer = exports.getActivePlayer = exports.setActivePlayer = exports.player1 = exports.player2 = void 0;\nvar messageController_1 = require(\"./messageController\");\nexports.player2 = { name: \"Player 2\" /* PLAYER_2 */ };\nexports.player1 = { name: \"Player 1\" /* PLAYER_1 */ };\nvar PLAYER_TIMEOUT_DURATION = 6000; // 6 seconds\nvar activePlayer = exports.player1;\nvar playerTimeout = null;\nexports.setActivePlayer = function (player) {\n    activePlayer = player;\n};\nexports.getActivePlayer = function () {\n    return activePlayer;\n};\nexports.togglePlayer = function () {\n    exports.setActivePlayer(activePlayer === exports.player2 ? exports.player1 : exports.player2);\n};\nexports.startPlayerTimer = function () {\n    if (playerTimeout) {\n        clearTimeout(playerTimeout);\n    }\n    playerTimeout = window.setTimeout(function () {\n        messageController_1.sendResponse({\n            msg: \"UPDATE_TEXT\" /* UPDATE_TEXT */,\n            body: {\n                newLine: null,\n                heading: exports.getActivePlayer().name,\n                message: \"Are you asleep?\"\n            }\n        });\n    }, PLAYER_TIMEOUT_DURATION);\n    return playerTimeout;\n};\n//# sourceMappingURL=playerController.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isGameOver = exports.removeEndNode = exports.addEndNode = exports.addStartNode = exports.isValidEndNode = exports.isValidStartNode = exports.setActiveNode = exports.getActiveNode = void 0;\nvar nodeController_1 = require(\"./nodeController\");\nvar visitedNodes = [];\nvar endNodes = [];\nvar activeNode = nodeController_1.EMPTY_NODE;\nexports.getActiveNode = function () { return activeNode; };\nexports.setActiveNode = function (node) { return activeNode = node; };\nexports.isValidStartNode = function (node) {\n    if (!endNodes.length) {\n        return true;\n    }\n    else if (endNodes.find(function (end) { return end.x === node.x && end.y === node.y; })) {\n        return true;\n    }\n    return false;\n};\nexports.isValidEndNode = function (node, start) {\n    if (start === void 0) { start = exports.getActiveNode(); }\n    if (isMovePossible(start, node)\n        && !isNodeVisited(node)\n        && !isLineIntersecting(start, node)) {\n        return true;\n    }\n    return false;\n};\nexports.addStartNode = function (node) {\n    exports.setActiveNode(node);\n};\nexports.addEndNode = function (node) {\n    if (!endNodes.length) {\n        visitedNodes.push(activeNode);\n        endNodes.push(activeNode);\n    }\n    else {\n        // Remove the old end point\n        endNodes = endNodes.filter(function (n) { return !(n.x === activeNode.x && n.y === activeNode.y); });\n    }\n    // Add the new end point\n    endNodes.push(node);\n    // Add the intermediate points\n    calculatePoints(activeNode, node).forEach(function (point) { return visitedNodes.push(point); });\n    // Set the active node to empty\n    exports.setActiveNode(nodeController_1.EMPTY_NODE);\n};\nexports.removeEndNode = function () {\n    exports.setActiveNode(nodeController_1.EMPTY_NODE);\n};\nvar isMovePossible = function (from, to) { return (from.x === to.x\n    || from.y === to.y\n    || Math.abs(from.x - to.x) === Math.abs(from.y - to.y)); };\nvar isNodeVisited = function (node) { return (!!visitedNodes.find(function (visited) { return visited.x === node.x && visited.y === node.y; })); };\nvar isLineIntersecting = function (from, to) {\n    var points = calculatePoints(from, to);\n    if (!points.length) {\n        // check same point\n        return true;\n    }\n    else if (points.length === 1) {\n        // check level-1 points\n        return [{\n                x: from.x + ((to.x - from.x) / Math.abs(to.x - from.x)),\n                y: from.y\n            }, {\n                x: from.x,\n                y: from.y + ((to.y - from.y) / Math.abs(to.y - from.y))\n            }].every(function (node) {\n            return visitedNodes.find(function (visited) {\n                return visited.x === node.x && visited.y === node.y;\n            });\n        });\n    }\n    else {\n        // check level-n points\n        return !points.every(function (p) {\n            return !visitedNodes.find(function (visited) {\n                return visited.x === p.x\n                    && visited.y === p.y;\n            });\n        });\n    }\n};\nvar calculatePoints = function (from, to) {\n    var points = [];\n    var xStep = (to.x - from.x) / Math.abs((to.x - from.x) || 1);\n    var yStep = (to.y - from.y) / Math.abs((to.y - from.y) || 1);\n    var point = __assign({}, from);\n    while (point.x !== to.x || point.y !== to.y) {\n        if (Math.abs(point.x) !== Math.abs(to.x)) {\n            point.x = point.x + 1 * xStep;\n        }\n        if (Math.abs(point.y) !== Math.abs(to.y)) {\n            point.y = point.y + 1 * yStep;\n        }\n        points.push(__assign({}, point));\n    }\n    return points;\n};\nexports.isGameOver = function () {\n    return !(getAdjacentNodes(endNodes[0]).some(function (node) { return exports.isValidEndNode(node, endNodes[0]); })\n        || getAdjacentNodes(endNodes[1]).some(function (node) { return exports.isValidEndNode(node, endNodes[1]); }));\n};\nvar getAdjacentNodes = function (node) {\n    var points = [];\n    [-1, 0, 1].forEach(function (dx) {\n        [-1, 0, 1].forEach(function (dy) {\n            var x = node.x + dx;\n            var y = node.y + dy;\n            if (x >= 0 && x <= 3 && y >= 0 && y <= 3 && !(x === node.x && y === node.y)) {\n                points.push({ x: x, y: y });\n            }\n        });\n    });\n    return points;\n};\n//# sourceMappingURL=stateController.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ClientAPI = __importStar(require(\"./ClientAPI\"));\nClientAPI.start(app);\n//# sourceMappingURL=index.js.map"],"sourceRoot":""}